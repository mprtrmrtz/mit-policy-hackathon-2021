


state_names <- list('United States', 'Alabama', 'Alaska', 'Arizona', 'Arkansas', 'California', 'Colorado', 'Connecticut', 'Delaware', 'District of Columbia', 'Florida', 'Georgia', 'Hawaii', 'Idaho', 'Illinois', 'Indiana', 'Iowa', 'Kansas', 'Kentucky', 'Louisiana', 'Maine', 'Maryland', 'Massachusetts', 'Michigan', 'Minnesota', 'Mississippi', 'Missouri', 'Montana', 'Nebraska', 'Nevada', 'New Hampshire', 'New Jersey', 'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio', 'Oklahoma', 'Oregon', 'Pennsylvania', 'Rhode Island', 'South Carolina', 'South Dakota', 'Tennessee', 'Texas', 'Utah', 'Vermont', 'Virginia', 'Washington', 'West Virginia', 'Wisconsin', 'Wyoming');

young_population <- list(275119242.705, 4070106.9639999997, 639763.25, 6085548.82, 2503211.1720000003, 33541602.456, 4959792.026, 2927415.9379999996, 795368.054, 624426.816, 17191049.792, 9178484.569, 1139674.86, 1529126.1809999999, 10560937.67, 5667405.567, 2609937.8249999997, 2438854.7849999997, 3725072.832, 3906712.438, 1063911.108, 5092929.482, 5721666.42, 8202474.765, 4735195.254, 2480233.0960000004, 5087330.1959999995, 872025.639, 1623668.576, 2632999.301, 1110781.575, 7407897.414, 1727181.58, 16068860.855999999, 8830485.559, 645155.487, 9646904.025, 3339876.937, 3469552.7260000003, 10392785.501999998, 870013.875, 4268356.720000001, 739169.6760000001, 5736732.722, 25573221.089, 2879392.794, 498677.60000000003, 7224663.483, 6470327.692, 1418905.665, 4811940.375, 482749.91199999995);

senior_population <- list(54364880.295, 851425.0360000001, 91394.75, 1335852.18, 527310.828, 5826475.544000001, 847926.9739999999, 629590.0619999999, 191440.94599999997, 88389.184, 4542262.208, 1531532.431, 267331.14, 297786.819, 2026592.33, 1087547.433, 553623.1749999999, 474950.215, 752178.1680000001, 738605.562, 286229.892, 962872.518, 1171907.58, 1764080.2349999999, 922146.746, 486552.9039999999, 1064217.804, 208551.361, 313883.424, 505259.699, 255493.425, 1474473.5860000001, 379137.42, 3267915.144, 1770337.4409999999, 120153.513, 2046312.9749999999, 640906.063, 771954.274, 2390468.498, 187111.125, 949683.28, 153547.324, 1150101.278, 3787537.9110000003, 370486.206, 124669.40000000001, 1365899.517, 1223284.308, 365881.33499999996, 1020714.6249999999, 99578.088)
ratio_young <- list(0.0007860987762019218, 0.0012837009066870315, 0.0002466537426149439, 0.0010406128004737624, 0.0010246039282218416, 0.0007790862119446976, 0.0004125374590857895, 0.0005433119289111421, 0.0005094496792550332, 0.0009847431023846357, 0.0010772698714780152, 0.0009606814647573876, 0.00027639462012876194, 0.0004987162011059702, 0.0006150116782196671, 0.0006428867595457195, 0.00047706117290361133, 0.0006052020846333417, 0.0007540792158127662, 0.0011260618921448244, 0.00020763012843738441, 0.0006150880374589095, 0.0004193533533540042, 0.0006420379398753322, 0.000317769367319948, 0.0014795786758584563, 0.0007415480919571905, 0.0006015878163875868, 0.00045397195640497514, 0.0010568935582106328, 0.00014944432257079886, 0.000956465728940776, 0.0010507870284258126, 0.00037542175852169817, 0.0006248127538554983, 0.0005301047683719072, 0.0005896710473389414, 0.0010050370308000362, 0.00034217667052683954, 0.0005959326302662684, 0.00046275124060521453, 0.000932162014799925, 0.0005840336989148888, 0.0010680992643254611, 0.0011302447939353516, 0.0003708768050768415, 9.104078466728805e-05, 0.00047077625248611183, 0.00033347615495082407, 0.0006593109204338824, 0.00038822176802221913, 0.0004567582396576387);

ratio_senior <- list(0.010116659818169107, 0.01238394403990723, 0.004343794364555951, 0.010041530193857229, 0.011755874658428218, 0.008992743486919199, 0.007710569660448142, 0.01177273983082662, 0.008274092001196026, 0.011562500678816088, 0.009118143802234678, 0.011123499349521773, 0.002091039599801205, 0.008684064689914969, 0.009665979541134451, 0.01197740862122011, 0.01060107355513071, 0.010268444662142115, 0.010642425346224619, 0.01232457548160191, 0.003511163676783276, 0.009112317400256302, 0.010676609839830544, 0.009015462950300557, 0.007945590039527179, 0.01475481893331789, 0.010854920822204173, 0.00837203838722491, 0.008541387645879637, 0.01064007283905697, 0.005252581353120927, 0.013701839213551024, 0.008574727337649763, 0.006882063642714953, 0.008372980007487736, 0.01311655365415741, 0.010834119839366215, 0.012878642404105328, 0.004254137985380207, 0.011011648980952185, 0.013147267432655327, 0.010181289071447061, 0.01198978889400899, 0.011549417650503647, 0.012873798532389132, 0.006297130533383475, 0.0021176006301466114, 0.0076923667291991585, 0.0049162733149357134, 0.008409830471401336, 0.007845483746252779, 0.0076824130224312);

#hypothesis testing:

for(i in 1:length(state_names)){
  m <- senior_population[[i]]
  n <- young_population[[i]]
  p_hat <- ratio_senior[[i]]
  q_hat <- ratio_young[[i]]
  Tn <- (p_hat - q_hat) / sqrt((p_hat * (1-p_hat) / m) + (q_hat * (1-q_hat) / n))
  p_value = 1 - pnorm(Tn)
  cat("Test statictics ",Tn, " ", "p_value for ",state_names[[i]]," ", p_value, "\n")
  
}


# Hypothesis: There is not difference between differentials between senior and young people. Finding evidence against this hypothesis. 
# Bernouli random variable for each person in the dataset. 
# Data for senior people, and data for young people. 

# Used CLT for the hypothesis testing of these two variables being equal. 